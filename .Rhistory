geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_lda <- LDA(comments_dtm,k=input$nTopics)
runApp()
comments_lda <- LDA(comments_dtm,k=input$nTopics)
comments_dtm <- data_count %>%
filter(n>100) %>%
cast_dtm(listing_id,word,n)
runApp()
runApp()
comments_lda
comments_lda
comments_lda <- LDA(comments_dtm,k=input$6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_lda <- LDA(comments_dtm,k=6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=1) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=3) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
output$visChart <- renderPlot({
comments_dtm <- data_count %>%
filter(n>100) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
#%>%
#mutate(term=reorder_within(term,beta,topic))
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
})
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_dtm <- data_count %>%
filter(n>20) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>30) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>40) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
output$visChart <- renderPlot({
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
#%>%
#mutate(term=reorder_within(term,beta,topic))
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
})
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>80) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>30) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=1) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
#slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_dtm <- data_count %>%
filter(n>30) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>40) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_dtm <- data_count %>%
filter(n>60) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=1) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
output$visChart <- renderPlot({
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
#%>%
#mutate(term=reorder_within(term,beta,topic))
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
})
comments_dtm <- data_count %>%
filter(n>50) %>%
cast_dtm(listing_id,word,n)
comments_lda <- LDA(comments_dtm,k=6)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=10) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=2) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=3) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=4) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(-beta,n=4) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=5) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
comments_topics <- tidy(comments_lda,matrix="beta") %>%
group_by(term) %>%
slice_max(beta,n=3) %>%
ungroup() %>%
arrange(topic,-beta)
comments_topics %>% mutate(term=reorder_within(term,beta,topic)) %>%
ggplot(aes(beta,term,fill=factor(topic)))+
geom_col()+
labs(fill = "Topics")+
facet_wrap(~topic,scales="free")+
scale_y_reordered()
runApp()
runApp()
runApp()
runApp()
